{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect, useState, useCallback } from \"react\";\nconst CommandHandler = ({\n  input,\n  setInput,\n  editor\n}) => {\n  _s();\n  const [isBold, setIsBold] = useState(false);\n  const checkForCommands = useCallback(value => {\n    const regex = /\\/(\\w+)/g;\n    let match;\n    while ((match = regex.exec(value)) !== null) {\n      handleCommand(match[1], match.index);\n    }\n  }, [input]);\n  const clear = useCallback((command, index) => {\n    const before = input.slice(0, index);\n    const after = input.slice(index + command.length + 1);\n    setInput(`${before}${after}`);\n  }, [input, setInput]);\n  const replace = useCallback((command, index, insert) => {\n    const before = input.slice(0, index);\n    const after = input.slice(index + command.length + 1);\n    setInput(`${before}${insert}${after}`);\n  }, [input, setInput]);\n  const handleCommand = useCallback((command, index) => {\n    switch (command) {\n      case \"d20\":\n        console.log(\"Rolled a d20: \", Math.floor(Math.random() * 20) + 1);\n        let insert = String(Math.floor(Math.random() * 20) + 1);\n        replace(command, index, insert);\n        break;\n      // Add more commands as needed\n      case \"bold\":\n        // console.log('triggering bold');\n\n        // Get the range index\n        const range = editor.getSelection();\n        editor.deleteText(range.index - command.length - 1, range.index);\n        editor.format('bold', !isBold);\n        setIsBold(!isBold);\n        break;\n      default:\n        console.log(`Command ${command} doesn't exist/isn't finished`);\n    }\n  }, [clear, editor, replace]);\n  useEffect(() => {\n    checkForCommands(input);\n  }, [input, checkForCommands]);\n\n  // Handles commands such as Ctrl+b and externally inputted commands\n  const handleKeyDown = e => {\n    if (e.ctrlKey && e.key === 'b') {\n      e.preventDefault();\n\n      // Get range, if selection, apply to selection, otherwise toggle bold\n      const range = editor.getSelection();\n      if (range) {\n        if (range.length === 0) {\n          editor.format('bold', !isBold);\n          setIsBold(!isBold);\n        } else {\n          const selectedBold = editor.getFormat(range.index, range.length)['bold'];\n          editor.formatText(range.index, range.length, 'bold', !selectedBold);\n        }\n      }\n    }\n  };\n  useEffect(() => {\n    // console.log(\"Noticed a keydown events\")\n    document.addEventListener('keydown', handleKeyDown);\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [input, isBold]);\n  return null;\n};\n_s(CommandHandler, \"SzPBTywwq1Jzu5Tg9BU8mybbQSM=\");\n_c = CommandHandler;\nexport default CommandHandler;\nvar _c;\n$RefreshReg$(_c, \"CommandHandler\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","CommandHandler","input","setInput","editor","_s","isBold","setIsBold","checkForCommands","value","regex","match","exec","handleCommand","index","clear","command","before","slice","after","length","replace","insert","console","log","Math","floor","random","String","range","getSelection","deleteText","format","handleKeyDown","e","ctrlKey","key","preventDefault","selectedBold","getFormat","formatText","document","addEventListener","removeEventListener","_c","$RefreshReg$"],"sources":["/home/grbaltz/LoreMasterNoteTaker/LoreMasterNoteTaker/frontend/src/handlers/CommandHandler.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\n\nconst CommandHandler = ({ input, setInput, editor }) => {\n    const [isBold, setIsBold] = useState(false)\n\n    const checkForCommands = useCallback((value) => {\n        const regex = /\\/(\\w+)/g;\n        let match;\n\n        while ((match = regex.exec(value)) !== null) {\n            handleCommand(match[1], match.index);\n        }\n    }, [input]);\n\n    const clear = useCallback((command, index) => {\n        const before = input.slice(0, index);\n        const after = input.slice(index + command.length + 1);\n        setInput(`${before}${after}`);\n    }, [input, setInput])\n\n    const replace = useCallback((command, index, insert) => {\n        const before = input.slice(0, index);\n        const after = input.slice(index + command.length + 1);\n        setInput(`${before}${insert}${after}`);\n    }, [input, setInput])\n\n    const handleCommand = useCallback((command, index) => {\n        switch (command) {\n            case \"d20\":\n                console.log(\n                    \"Rolled a d20: \",\n                    Math.floor(Math.random() * 20) + 1\n                );\n                let insert = String(Math.floor(Math.random() * 20) + 1);\n                replace(command, index, insert);\n                break;\n            // Add more commands as needed\n            case \"bold\":\n                // console.log('triggering bold');\n\n                // Get the range index\n                const range = editor.getSelection()\n                editor.deleteText(range.index - command.length - 1, range.index)\n                editor.format('bold', !isBold)\n                setIsBold(!isBold)\n                break;\n            default:\n                console.log(\n                    `Command ${command} doesn't exist/isn't finished`\n                );\n        }\n    }, [clear, editor, replace]);\n\n    useEffect(() => {\n        checkForCommands(input);\n    }, [input, checkForCommands]);\n\n    // Handles commands such as Ctrl+b and externally inputted commands\n    const handleKeyDown = (e) => {\n        if (e.ctrlKey && e.key === 'b') {\n            e.preventDefault();\n\n            // Get range, if selection, apply to selection, otherwise toggle bold\n            const range = editor.getSelection()\n            if (range) {\n                if (range.length === 0) {\n                    editor.format('bold', !isBold)\n                    setIsBold(!isBold)\n                } else {\n                    const selectedBold = editor.getFormat(range.index, range.length)['bold']\n                    editor.formatText(range.index, range.length, 'bold', !selectedBold)\n                }\n            }\n\n        }\n    }\n\n    useEffect(() => {\n        // console.log(\"Noticed a keydown events\")\n        document.addEventListener('keydown', handleKeyDown);\n        return () => {\n            document.removeEventListener('keydown', handleKeyDown);\n        }\n    }, [input, isBold])\n\n    return null;\n};\n\nexport default CommandHandler;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}