{"ast":null,"code":"var _jsxFileName = \"D:\\\\Personal Projects\\\\LMNT\\\\frontend\\\\src\\\\contexts\\\\PagesContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useReducer, useEffect } from \"react\";\nimport axios from 'axios';\n\n// Create the PagesContext\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const PagesContext = /*#__PURE__*/createContext();\nconst structurePages = pages => {\n  const pageMap = new Map();\n\n  // Create a mpa of page ids to objects\n  pages.forEach(page => pageMap.set(page._id, {\n    ...page,\n    children: []\n  }));\n  const structuredPages = [];\n  pageMap.forEach((page, id) => {\n    if (page.parent) {\n      if (pageMap.has(page.parent)) {\n        pageMap.get(page.parent).children.push(page); // adds the current page to the list of children for the parent page\n      }\n    } else {\n      structuredPages.push(page); // top level page, hence saved in top level list\n    }\n  });\n  return structuredPages;\n};\n\n// Define the reducer to handle different actions\nexport const pagesReducer = (state, action) => {\n  switch (action.type) {\n    case 'SET_PAGES':\n      return {\n        ...state,\n        pages: structurePages(action.payload)\n      };\n    case 'CREATE_PAGE':\n      return {\n        ...state,\n        pages: structurePages([action.payload, ...state.pages])\n      };\n    case 'DELETE_PAGE':\n      return {\n        ...state,\n        pages: state.pages.filter(page => page._id !== action.payload)\n      };\n    case 'UPDATE_PAGE':\n      return {\n        ...state,\n        pages: state.pages.map(page => page._id === action.payload._id ? action.payload : page)\n      };\n    default:\n      console.warn(`Unhandled action type: ${action.type}`);\n      return state;\n  }\n};\n\n// PagesContextProvider component to provide context to its children\nexport const PagesContextProvider = ({\n  children\n}) => {\n  _s();\n  const [state, dispatch] = useReducer(pagesReducer, {\n    pages: []\n  });\n  useEffect(() => {\n    // Fetch all pages from the server when the provider mounts\n    const fetchPages = async () => {\n      try {\n        const response = await axios.get('/pages/');\n        dispatch({\n          type: 'SET_PAGES',\n          payload: response.data\n        });\n      } catch (error) {\n        console.error('Failed to fetch pages', error);\n      }\n    };\n    fetchPages();\n  }, []); // Empty dependency array ensures this runs once on mount\n\n  return /*#__PURE__*/_jsxDEV(PagesContext.Provider, {\n    value: {\n      ...state,\n      dispatch\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 9\n  }, this);\n};\n_s(PagesContextProvider, \"iIwwLJe9D+Q+V0B/74YmoF/swtE=\");\n_c = PagesContextProvider;\nvar _c;\n$RefreshReg$(_c, \"PagesContextProvider\");","map":{"version":3,"names":["React","createContext","useReducer","useEffect","axios","jsxDEV","_jsxDEV","PagesContext","structurePages","pages","pageMap","Map","forEach","page","set","_id","children","structuredPages","id","parent","has","get","push","pagesReducer","state","action","type","payload","filter","map","console","warn","PagesContextProvider","_s","dispatch","fetchPages","response","data","error","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/Personal Projects/LMNT/frontend/src/contexts/PagesContext.js"],"sourcesContent":["import React, { createContext, useReducer, useEffect } from \"react\";\r\nimport axios from 'axios';\r\n\r\n// Create the PagesContext\r\nexport const PagesContext = createContext();\r\n\r\nconst structurePages = (pages) => {\r\n    const pageMap = new Map();\r\n\r\n    // Create a mpa of page ids to objects\r\n    pages.forEach(page => pageMap.set(page._id, { ...page, children: [] }));\r\n\r\n    const structuredPages = [];\r\n\r\n    pageMap.forEach((page, id) => {\r\n        if (page.parent) {\r\n            if (pageMap.has(page.parent)) {\r\n                pageMap.get(page.parent).children.push(page); // adds the current page to the list of children for the parent page\r\n            }\r\n        } else {\r\n            structuredPages.push(page); // top level page, hence saved in top level list\r\n        }\r\n    });\r\n\r\n    return structuredPages;\r\n}\r\n\r\n// Define the reducer to handle different actions\r\nexport const pagesReducer = (state, action) => {\r\n    switch (action.type) {\r\n        case 'SET_PAGES':\r\n            return {\r\n                ...state,\r\n                pages: structurePages(action.payload)\r\n            };\r\n        case 'CREATE_PAGE':\r\n            return {\r\n                ...state,\r\n                pages: structurePages([action.payload, ...state.pages])\r\n            };\r\n        case 'DELETE_PAGE':\r\n            return {\r\n                ...state,\r\n                pages: state.pages.filter(page => page._id !== action.payload)\r\n            };\r\n        case 'UPDATE_PAGE':\r\n            return {\r\n                ...state,\r\n                pages: state.pages.map(page =>\r\n                    page._id === action.payload._id ? action.payload : page\r\n                )\r\n            };\r\n        default:\r\n            console.warn(`Unhandled action type: ${action.type}`);\r\n            return state;\r\n    }\r\n};\r\n\r\n// PagesContextProvider component to provide context to its children\r\nexport const PagesContextProvider = ({ children }) => {\r\n    const [state, dispatch] = useReducer(pagesReducer, {\r\n        pages: []\r\n    });\r\n\r\n    useEffect(() => {\r\n        // Fetch all pages from the server when the provider mounts\r\n        const fetchPages = async () => {\r\n            try {\r\n                const response = await axios.get('/pages/');\r\n                dispatch({ type: 'SET_PAGES', payload: response.data });\r\n            } catch (error) {\r\n                console.error('Failed to fetch pages', error);\r\n            }\r\n        };\r\n\r\n        fetchPages();\r\n    }, []); // Empty dependency array ensures this runs once on mount\r\n\r\n    return (\r\n        <PagesContext.Provider value={{ ...state, dispatch }}>\r\n            {children}\r\n        </PagesContext.Provider>\r\n    );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}